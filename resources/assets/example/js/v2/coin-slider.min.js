(function(e){var t=new Array,n=new Array,r=new Array,s=new Array,o=new Array,u=new Array,a=new Array,f=new Array,l=new Array,c=new Array,h=new Array;e.fn.coinslider=e.fn.CoinSlider=function(p){init=function(i){n[i.id]=new Array,r[i.id]=new Array,s[i.id]=new Array,o[i.id]=new Array,u[i.id]=new Array,f[i.id]=0,c[i.id]=0,h[i.id]=1,t[i.id]=e.extend({},e.fn.coinslider.defaults,p),e.each(e("#"+i.id+" img"),function(t,n){r[i.id][t]=e(n).attr("src"),s[i.id][t]=e(n).parent().is("item")?e(n).parent().attr("data"):"",o[i.id][t]=e(n).parent().is("item")?e(n).parent().attr("target"):"",u[i.id][t]=e(n).next().is("span")?e(n).next().html():"",e(n).hide(),e(n).next().hide()}),e(i).css({"background-image":"url("+r[i.id][0]+")",width:t[i.id].width,height:t[i.id].height,position:"relative","background-position":"top left"}).wrap("<div class='coin-slider' id='coin-slider-"+i.id+"' />"),e("#"+i.id).append("<div class='cs-title' id='cs-title-"+i.id+"' style='position: absolute; bottom:0; left: 0; z-index: 1000;'></div>"),e.setFields(i),t[i.id].navigation&&e.setNavigation(i),e.transition(i,0),e.transitionCall(i)},e.setFields=function(r){tWidth=sWidth=parseInt(t[r.id].width/t[r.id].spw),tHeight=sHeight=parseInt(t[r.id].height/t[r.id].sph),counter=sLeft=sTop=0,tgapx=gapx=t[r.id].width-t[r.id].spw*sWidth,tgapy=gapy=t[r.id].height-t[r.id].sph*sHeight;for(i=1;i<=t[r.id].sph;i++){gapx=tgapx,gapy>0?(gapy--,sHeight=tHeight+1):sHeight=tHeight;for(j=1;j<=t[r.id].spw;j++)gapx>0?(gapx--,sWidth=tWidth+1):sWidth=tWidth,n[r.id][counter]=i+""+j,counter++,t[r.id].links?e("#"+r.id).append("<a href='"+s[r.id][0]+"' class='cs-"+r.id+"' id='cs-"+r.id+i+j+"' style='width:"+sWidth+"px; height:"+sHeight+"px; float: left; position: absolute;'></a>"):e("#"+r.id).append("<div class='cs-"+r.id+"' id='cs-"+r.id+i+j+"' style='width:"+sWidth+"px; height:"+sHeight+"px; float: left; position: absolute;'></div>"),e("#cs-"+r.id+i+j).css({"background-position":-sLeft+"px "+(-sTop+"px"),left:sLeft,top:sTop}),sLeft+=sWidth;sTop+=sHeight,sLeft=0}e(".cs-"+r.id).mouseover(function(){e("#cs-navigation-"+r.id).show()}),e(".cs-"+r.id).mouseout(function(){e("#cs-navigation-"+r.id).hide()}),e("#cs-title-"+r.id).mouseover(function(){e("#cs-navigation-"+r.id).show()}),e("#cs-title-"+r.id).mouseout(function(){e("#cs-navigation-"+r.id).hide()}),t[r.id].hoverPause&&(e(".cs-"+r.id).mouseover(function(){t[r.id].pause=!0}),e(".cs-"+r.id).mouseout(function(){t[r.id].pause=!1}),e("#cs-title-"+r.id).mouseover(function(){t[r.id].pause=!0}),e("#cs-title-"+r.id).mouseout(function(){t[r.id].pause=!1}))},e.transitionCall=function(n){clearInterval(a[n.id]),delay=t[n.id].delay+t[n.id].spw*t[n.id].sph*t[n.id].sDelay,a[n.id]=setInterval(function(){e.transition(n)},delay)},e.transition=function(i,s){if(t[i.id].pause==1)return;e.effect(i),c[i.id]=0,l[i.id]=setInterval(function(){e.appereance(i,n[i.id][c[i.id]])},t[i.id].sDelay),e(i).css({"background-image":"url("+r[i.id][f[i.id]]+")"}),typeof s=="undefined"?f[i.id]++:s=="prev"?f[i.id]--:f[i.id]=s,f[i.id]==r[i.id].length&&(f[i.id]=0),f[i.id]==-1&&(f[i.id]=r[i.id].length-1),e(".cs-button-"+i.id).removeClass("cs-active"),e("#cs-button-"+i.id+"-"+(f[i.id]+1)).addClass("cs-active"),u[i.id][f[i.id]]?(e("#cs-title-"+i.id).css({opacity:0}).animate({opacity:t[i.id].opacity},t[i.id].titleSpeed),e("#cs-title-"+i.id).html(u[i.id][f[i.id]])):e("#cs-title-"+i.id).css("opacity",0)},e.appereance=function(n,i){e(".cs-"+n.id).attr("href",s[n.id][f[n.id]]).attr("target",o[n.id][f[n.id]]);if(c[n.id]==t[n.id].spw*t[n.id].sph){clearInterval(l[n.id]);return}e("#cs-"+n.id+i).css({opacity:0,"background-image":"url("+r[n.id][f[n.id]]+")"}),e("#cs-"+n.id+i).animate({opacity:1},300),c[n.id]++},e.setNavigation=function(n){e(n).append("<div id='cs-navigation-"+n.id+"'></div>"),e("#cs-navigation-"+n.id).hide(),e("#cs-navigation-"+n.id).append("<a href='#' id='cs-prev-"+n.id+"' class='cs-prev'>prev</a>"),e("#cs-navigation-"+n.id).append("<a href='#' id='cs-next-"+n.id+"' class='cs-next'>next</a>"),e("#cs-prev-"+n.id).css({position:"absolute",top:t[n.id].height/2-15,left:0,"z-index":1001,"line-height":"30px",opacity:t[n.id].opacity}).click(function(t){t.preventDefault(),e.transition(n,"prev"),e.transitionCall(n)}).mouseover(function(){e("#cs-navigation-"+n.id).show()}),e("#cs-next-"+n.id).css({position:"absolute",top:t[n.id].height/2-15,right:0,"z-index":1001,"line-height":"30px",opacity:t[n.id].opacity}).click(function(t){t.preventDefault(),e.transition(n),e.transitionCall(n)}).mouseover(function(){e("#cs-navigation-"+n.id).show()}),e("<div id='cs-buttons-"+n.id+"' class='cs-buttons'></div>").appendTo(e("#coin-slider-"+n.id));for(k=1;k<r[n.id].length+1;k++)e("#cs-buttons-"+n.id).append("<a href='#' class='cs-button-"+n.id+"' id='cs-button-"+n.id+"-"+k+"'>"+k+"</a>");e.each(e(".cs-button-"+n.id),function(t,r){e(r).click(function(r){e(".cs-button-"+n.id).removeClass("cs-active"),e(this).addClass("cs-active"),r.preventDefault(),e.transition(n,t),e.transitionCall(n)})}),e("#cs-navigation-"+n.id+" a").mouseout(function(){e("#cs-navigation-"+n.id).hide(),t[n.id].pause=!1}),e("#cs-buttons-"+n.id).css({left:"50%","margin-left":-r[n.id].length*15/2-5,position:"relative"})},e.effect=function(r){effA=["random","swirl","rain","straight"],t[r.id].effect==""?eff=effA[Math.floor(Math.random()*effA.length)]:eff=t[r.id].effect,n[r.id]=new Array;if(eff=="random"){counter=0;for(i=1;i<=t[r.id].sph;i++)for(j=1;j<=t[r.id].spw;j++)n[r.id][counter]=i+""+j,counter++;e.random(n[r.id])}eff=="rain"&&e.rain(r),eff=="swirl"&&e.swirl(r),eff=="straight"&&e.straight(r),h[r.id]*=-1,h[r.id]>0&&n[r.id].reverse()},e.random=function(e){var t=e.length;if(t==0)return!1;while(--t){var n=Math.floor(Math.random()*(t+1)),r=e[t],i=e[n];e[t]=i,e[n]=r}},e.swirl=function(r){var s=t[r.id].sph,o=t[r.id].spw,u=1,a=1,f=0,l=0,c=0,h=!0;while(h){l=f==0||f==2?o:s;for(i=1;i<=l;i++){n[r.id][c]=u+""+a,c++;if(i!=l)switch(f){case 0:a++;break;case 1:u++;break;case 2:a--;break;case 3:u--}}f=(f+1)%4;switch(f){case 0:o--,a++;break;case 1:s--,u++;break;case 2:o--,a--;break;case 3:s--,u--}check=e.max(s,o)-e.min(s,o),o<=check&&s<=check&&(h=!1)}},e.rain=function(e){var r=t[e.id].sph,s=t[e.id].spw,o=0,u=to2=from=1,a=!0;while(a){for(i=from;i<=u;i++)n[e.id][o]=i+""+parseInt(to2-i+1),o++;to2++,u<r&&to2<s&&r<s&&u++,u<r&&r>=s&&u++,to2>s&&from++,from>u&&(a=!1)}},e.straight=function(e){counter=0;for(i=1;i<=t[e.id].sph;i++)for(j=1;j<=t[e.id].spw;j++)n[e.id][counter]=i+""+j,counter++},e.min=function(e,t){return e>t?t:e},e.max=function(e,t){return e<t?t:e},this.each(function(){init(this)})},e.fn.coinslider.defaults={width:565,height:290,spw:7,sph:5,delay:3e3,sDelay:30,opacity:.7,titleSpeed:500,effect:"",navigation:!0,links:!0,hoverPause:!0}})(jQuery)